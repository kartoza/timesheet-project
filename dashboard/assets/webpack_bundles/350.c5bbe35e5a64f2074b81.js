"use strict";(self.webpackChunkdashboard=self.webpackChunkdashboard||[]).push([[350],{350:(e,t,n)=>{n.r(t),n.d(t,{TimeCard:()=>Z,default:()=>B});var i=n(74848),r=n(33551),a=n(1043),s=n(78717),o=n(51841),l=n(56239),u=n(56826),c=n(75737),d=n(63342),f=n(46299),m=n(99941),p=n(97981),h=n(95093),v=n.n(h),g=n(96540),x=n(63661),b=n(51125),j=n(42571),y=n(82876),w=n(62430),T=n(85072),A=n.n(T),S=n(97825),k=n.n(S),D=n(77659),C=n.n(D),E=n(55056),z=n.n(E),M=n(10540),H=n.n(M),I=n(41113),O=n.n(I),L=n(76465),Y={};Y.styleTagTransform=O(),Y.setAttributes=z(),Y.insert=C().bind(null,"head"),Y.domAPI=k(),Y.insertStyleElement=H(),A()(L.A,Y),L.A&&L.A.locals&&L.A.locals;var F=function(){return F=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},F.apply(this,arguments)};function N(e){var t=(0,g.useState)("00"),n=t[0],r=t[1],a=(0,g.useState)("00"),s=a[0],o=a[1],l=(0,g.useState)("00"),u=l[0],c=l[1],d=(0,g.useState)(""),f=d[0],m=d[1];return(0,g.useEffect)((function(){if(e.runningTime!==f){var t=e.runningTime.split(":");r(t[0]),o(t[1]),c(t[2]),m(e.runningTime)}}),[e.runningTime,f]),(0,g.useEffect)((function(){var t=""+[n,s,u].join(":");t!==e.runningTime&&(e.onChange(t),m(t))}),[n,s,u,f,e.runningTime]),(0,i.jsxs)("div",F({style:{display:"flex"}},{children:[(0,i.jsx)("input",{type:"text",disabled:e.disabled,value:n,pattern:"[0-9]",maxLength:2,onChange:function(e){var t=e.target.value;""!==t?/^\d{0,2}$/.test(t)&&r(t):r("00")},className:"numberBox"}),(0,i.jsx)("div",F({className:"timeSeparator"},{children:":"})),(0,i.jsx)("input",{type:"text",value:s,disabled:e.disabled,pattern:"[0-9]",maxLength:2,onChange:function(e){var t=e.target.value;if(""!==t){if(/^\d{0,2}$/.test(t)){if(parseInt(t)>=60)return void o("59");o(t)}}else o("00")},className:"numberBox"}),(0,i.jsx)("div",F({className:"timeSeparator"},{children:":"})),(0,i.jsx)("input",{type:"text",value:u,disabled:e.disabled,pattern:"[0-9]",maxLength:2,onChange:function(e){var t=e.target.value;if(""!==t){if(/^\d{0,2}$/.test(t)){if(parseInt(t)>=60)return void c("59");c(t)}}else c("00")},className:"numberBox"})]}))}var U=function(){return U=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},U.apply(this,arguments)},_=null,Z=(0,g.forwardRef)((function(e,t){var n=e.runningTimeLog,h=e.editingTimeLog,T=e.toggleTimer,A=e.task,S=e.project,k=e.activity,D=e.description,C=e.parent,E=e.isUnavailable,z=e.clearAllFields,M=g.useState(new Date),H=M[0],I=M[1],O=g.useState(null),L=O[0],Y=O[1],F=g.useState(null),Z=F[0],B=F[1],P=g.useState(""),R=P[0],$=P[1],W=g.useState(!0),q=W[0],G=W[1],J=g.useState(!0),K=J[0],Q=J[1],V=(0,g.useState)(!1),X=V[0],ee=V[1],te=(0,g.useState)("00:00:00"),ne=te[0],ie=te[1],re=(0,g.useState)(null),ae=re[0],se=re[1],oe=(0,g.useState)(null),le=oe[0],ue=oe[1],ce=(0,g.useState)(null),de=ce[0],fe=ce[1],me=g.useState(!1),pe=me[0],he=me[1],ve=(0,g.useState)(0),ge=ve[0],xe=ve[1],be=(0,g.useState)(""),je=be[0],ye=be[1],we=(0,x.AC)(),Te=we[0],Ae=we[1],Se=Ae.isLoading,ke=Ae.isSuccess,De=Ae.isError,Ce=Ae.error,Ee=Ae.data,ze=(0,x.c3)(),Me=ze[0],He=ze[1],Ie=He.isLoading,Oe=He.isSuccess,Le=(He.isError,He.data),Ye=(0,x.We)(),Fe=Ye[0],Ne=Ye[1];Ne.isLoading,Ne.isSuccess,Ne.isError,(0,g.useEffect)((function(){ue(Le)}),[Le]),(0,g.useEffect)((function(){fe(Ee)}),[Ee]),(0,g.useEffect)((function(){G(null==H||null==Z||!k),Q(!k)}),[H,Z,A,k,D]),(0,g.useEffect)((function(){if(pe&&!L&&Z){var e=new Date(H.getTime());e.setHours(e.getHours()+parseFloat(Z)),Y(e)}}),[pe]);var Ue=(0,g.useCallback)((function(e){void 0===e&&(e=!0),B(null),$(""),z(e),ue(null),fe(null)}),[z]);(0,g.useEffect)((function(){ke&&de&&(de.running?(T(!0),se(de)):(se(null),L&&I(L),Ue(!1)))}),[ke,de,Ue]),(0,g.useEffect)((function(){(ae||h)&&le&&!le.running&&(T(!1),clearInterval(_),Q(!0),ie("00:00:00"),se(null),Ue())}),[ae,h,Oe,le,Ue]),(0,g.useEffect)((function(){if(h){B(h.hours),$(h.hours);var e=v()(h.from_time,"YYYY-MM-DD hh:mm:ss").toDate();I(e);var t=new Date(e.getTime());t.setHours(t.getHours()+h.hours),Y(t)}}),[h]),(0,g.useEffect)((function(){n&&se(n)}),[n]);var _e=(0,g.useCallback)((function(){var e=v()(ae.from_time,"YYYY-MM-DD hh:mm:ss"),t=v()().diff(e);v().duration(t),ie(v().utc(t).format("HH:mm:ss"))}),[ae]),Ze=(0,g.useCallback)((function(){_e(),_=setInterval(_e,1e3)}),[_e]);(0,g.useEffect)((function(){if(ae){Q(!1),Ze();var e=document.querySelector("link[rel~='icon']");e&&(e.href="/static/running-favicon.ico")}else _&&clearInterval(_)}),[ae,Ze]);var Be=function(){I(v()().toDate())},Pe=function(e){B(e.hours),$(e.hours);var t=v()(e.from_time,"YYYY-MM-DD hh:mm:ss").toDate();I(t)};(0,g.useImperativeHandle)(t,(function(){return{startButtonClicked:We,updateHours:Pe,resetStartTime:Be}}));var Re=(0,g.useCallback)((function(){var e=null;if(G(!0),null!=Z&&H){var t=new Date(H.toISOString());e=Z>0?(0,b.LY)(Z,t):t}if(e&&H&&k){var n=A?A.id:"-",i="function"==typeof H.toDate?H.toDate():H,r=(0,b.fU)(i),a=(0,b.fU)(e),s=Intl.DateTimeFormat().resolvedOptions().timeZone;Te({start_time:r,end_time:a,task:{id:n},activity:{id:k.id},project:{id:S?S.id:""},description:D,timezone:s})}}),[Te,Z,H,k,A,S,D]),$e=(0,g.useCallback)((function(e){if(void 0===e&&(e=!1),ee(!1),Q(!0),clearInterval(_),H&&k){var t=A?A.id:"-",n=Intl.DateTimeFormat().resolvedOptions().timeZone,i=ne;e&&(i="00:00:00");var r=(0,b.fU)(new Date);if("00:00:00"!==i){var a=i.split(":").map(Number),s=1e3*(60*a[0]*60+60*a[1]+a[2]),o=new Date((new Date).getTime()-s);r=(0,b.fU)(o)}Te({start_time:r,task:{id:t},activity:{id:k.id},project:{id:S?S.id:""},description:D,timezone:n,parent:C})}}),[Te,H,k,A,ne,S,D,C,_]),We=function(e){void 0===e&&(e=!1),xe(0),ye("start"),$e(e)};(0,g.useEffect)((function(){if(De){if(ge<3){var e=setTimeout((function(){"submit"===je?(G(!0),Re()):"start"===je&&(Q(!0),$e(!1)),xe((function(e){return e+1}))}),1e3);return function(){return clearTimeout(e)}}Q(!1),G(!1),alert("Failed to add timesheet, please try again later.")}}),[De,ge,je,Re,$e,Ce]);var qe=function(e,t){if(e&&t){[e,t].forEach((function(e){var t=e.getMinutes();e.getSeconds()>=30&&e.setMinutes(t+1),e.setSeconds(0,0)}));var n=(t.getTime()-e.getTime())/36e5;(n=parseFloat(n.toFixed(2)))>0?(B(n),$(n+"")):(B(null),$(""))}};return(0,i.jsxs)(c.$,U({dateAdapter:m.h},{children:[X||h?(0,i.jsxs)("div",{children:[(0,i.jsxs)(l.A,U({sx:{paddingLeft:0,paddingRight:0,paddingTop:0}},{children:[(0,i.jsxs)(o.A,U({container:!0,spacing:.6},{children:[(0,i.jsx)(o.A,U({size:7,className:"time-picker"},{children:(0,i.jsx)(d.l,{value:H,onChange:function(e){return I(e)},format:"dd/MM/yyyy",className:"date-picker-input"})})),(0,i.jsx)(o.A,U({size:1,style:{marginTop:15}},{children:(0,i.jsx)(r.A,U({color:"text.primary"},{children:":"}))})),(0,i.jsx)(o.A,U({size:4,className:"time-picker"},{children:(0,i.jsx)(f.A,{ampm:!1,value:H,onChange:function(e){I(e),qe(e,L)},viewRenderers:{hours:p.Zo,minutes:p.Zo,seconds:p.Zo}})}))]})),(0,i.jsxs)(o.A,U({container:!0,spacing:.6},{children:[(0,i.jsx)(o.A,U({size:10},{children:pe?(0,i.jsx)("div",U({style:{marginLeft:"-20px"}},{children:(0,i.jsx)(f.A,{ampm:!1,value:L,onChange:function(e){Y(e),qe(H,e)},viewRenderers:{hours:p.Zo,minutes:p.Zo,seconds:p.Zo}})})):(0,i.jsx)(a.A,{error:R.length>4&&!Z,value:R,id:"hour",onChange:function(e){var t=e.target.value;if(B(null),$(t),t){var n=H;v().isMoment(H)&&(n=n.toDate(),I(n));var i=new Date(n.getTime());if(!isNaN(t)){var r=parseFloat(t);B(r);var a=60*(r-Math.floor(r));return i.setHours(i.getHours()+r),i.setMinutes(i.getMinutes()+a),void Y(i)}var s=t.match(/(0?[0-9]|1[0-2])(:|.)[0-9]{2}/g);if(s&&s.length>0){var o=s[0];if(r=0,o.includes(":")){var l=o.split(":")[1],u=o.split(":")[0];r=parseFloat((parseFloat(u)+parseFloat(l)/60).toFixed(2))}else r=parseFloat(o);B(r),a=60*(r-Math.floor(r)),i.setHours(i.getHours()+r),i.setMinutes(i.getMinutes()+a),Y(i)}}},type:"text",helperText:"HH:MM or decimal",InputProps:{inputProps:{min:0}},label:"Hours",variant:"standard",sx:{width:"100%"}})})),(0,i.jsx)(o.A,U({size:2},{children:(0,i.jsx)(j.A,U({variant:"text",onClick:function(){return he(!pe)},style:{minWidth:0,paddingLeft:4,paddingRight:4,marginTop:12}},{children:(0,i.jsx)(w.A,{})}))}))]}))]})),(0,i.jsx)(u.A,U({sx:{justifyContent:"center",padding:0,marginBottom:"10px",marginTop:"4px"}},{children:h?(0,i.jsxs)("div",U({style:{width:"100%"}},{children:[(0,i.jsx)(j.A,U({color:"warning",variant:"contained",size:"small",sx:{width:"50%",marginTop:-1},onClick:function(){Ue()},disabled:Ie||E,disableElevation:!0},{children:"Cancel"})),(0,i.jsx)(j.A,U({color:"success",variant:"contained",size:"small",sx:{width:"50%",marginTop:-1},onClick:function(){var e=null;if(null!=Z&&H){var t=new Date(H.toISOString());e=(0,b.LY)(Z,t)}if(h&&H&&e&&k&&h){var n=Object.assign({},h),i="";A&&(i=A.id),i||(i="-"),n.task={id:i},n.activity={id:k.id},n.project={id:S?S.id:""},n.description=D,n.end_time=(0,b.fU)(e);var r=H;"function"==typeof H.toDate&&(r=H.toDate()),n.start_time=(0,b.fU)(r),n.editing=!0,Me(n)}},disabled:q||Ie||E,disableElevation:!0},{children:Ie?(0,i.jsx)(s.A,{color:"inherit",size:20}):"Save"}))]})):(0,i.jsx)(j.A,U({variant:"contained",size:"small",sx:{width:"100%",marginTop:-1},onClick:function(){xe(0),ye("submit"),Re()},disabled:q||Se||E,disableElevation:!0},{children:Se?(0,i.jsx)(s.A,{color:"inherit",size:20}):"Add"}))}))]}):(0,i.jsxs)("div",U({style:{marginTop:"8px",marginBottom:"0.5em"}},{children:[(0,i.jsx)(N,{disabled:ae,runningTime:ne,onChange:function(e){return ie(e)}}),(0,i.jsx)(l.A,U({sx:{paddingLeft:0,paddingRight:0}},{children:ae?(0,i.jsx)(j.A,U({color:"info",variant:"contained",size:"small",sx:{width:"100%",height:"58px",marginTop:-1},onClick:function(){return e=void 0,t=void 0,i=function(){var e,t,n;return function(e,t){var n,i,r,a,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return a={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function o(a){return function(o){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&a[0]?i.return:a[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,a[1])).done)return r;switch(i=0,r&&(a=[2&a[0],r.value]),a[0]){case 0:case 1:r=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((r=(r=s.trys).length>0&&r[r.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!r||a[1]>r[0]&&a[1]<r[3])){s.label=a[1];break}if(6===a[0]&&s.label<r[1]){s.label=r[1],r=a;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(a);break}r[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=r=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,o])}}}(this,(function(i){return ae?(clearInterval(_),Q(!0),(e=document.querySelector("link[rel~='icon']"))&&(e.href="/static/timesheet-logo.png"),t=Object.assign({},ae),n="",A&&(n=A.id),n||(n="-"),t.task={id:n},t.activity={id:k.id},t.project={id:S?S.id:""},t.description=D,t.end_time=(0,b.fU)(new Date),Me(t),[2]):[2]}))},new((n=void 0)||(n=Promise))((function(r,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function o(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,o)}l((i=i.apply(e,t||[])).next())}));var e,t,n,i},disabled:K,disableElevation:!0},{children:Ie?(0,i.jsx)(s.A,{color:"inherit",size:20}):"STOP"})):(0,i.jsx)(j.A,U({color:"success",variant:"contained",size:"small",sx:{width:"100%",height:"58px",marginTop:-1},onClick:function(){return We(!1)},disabled:K||E,disableElevation:!0},{children:Se?(0,i.jsx)(s.A,{color:"inherit",size:20}):"START"}))}))]})),(0,i.jsx)("div",U({style:{marginTop:"3px"}},{children:(0,i.jsxs)(o.A,U({container:!0,spacing:.6},{children:[(0,i.jsx)(o.A,U({size:6},{children:(0,i.jsx)(j.A,U({variant:"outlined",disabled:!X||h,color:"success",style:{width:"100%"},onClick:function(){return ee(!1)}},{children:(0,i.jsx)(y.g0,{})}))})),(0,i.jsx)(o.A,U({size:6},{children:(0,i.jsx)(j.A,U({variant:"outlined",disabled:X||h||ae,color:"success",style:{width:"100%"},onClick:function(){return ee(!0)}},{children:(0,i.jsx)(y.kp,{})}))}))]}))})),(0,i.jsx)("div",U({style:{marginTop:"auto"}},{children:(0,i.jsx)(j.A,U({onClick:function(){confirm("Are you sure you want to clear submitted timesheets?")&&Fe({})},style:{width:"100%"},startIcon:(0,i.jsx)(y.mW,{}),variant:"outlined",color:"warning"},{children:"Clear Submitted"}))}))]}))}));const B=Z},51125:(e,t,n)=>{function i(e,t){void 0===t&&(t=new Date);var n=e/3600;return t.setTime(t.getTime()+60*n*60*60*60*1e3),t}function r(e){void 0===e&&(e=new Date);var t=6e4*(new Date).getTimezoneOffset();return new Date(e.getTime()-t).toISOString().slice(0,-1).replace("T"," ").split(".")[0]}function a(e){if(!e)return!1;var t=new Date;return t.setHours(0,0,0,0),e.split(",").map((function(e){var t=new Date(e.trim());return t.setHours(0,0,0,0),t})).some((function(e){return e.getTime()===t.getTime()}))}n.d(t,{LY:()=>i,Or:()=>a,fU:()=>r})},76465:(e,t,n)=>{n.d(t,{A:()=>o});var i=n(31601),r=n.n(i),a=n(76314),s=n.n(a)()(r());s.push([e.id,"input::-webkit-outer-spin-button,input::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield}.numberBox{color:#1d575c;font-size:3rem;width:100%;text-align:center;background-color:rgba(0,0,0,0);border-width:0}.timeSeparator{color:#1d575c;font-size:3rem;margin-top:-4px}",""]);const o=s}}]);